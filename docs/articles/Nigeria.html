<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulation of IASC criteria - Nigeria • DurableSolutionsSimulation</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Simulation of IASC criteria - Nigeria">
<meta property="og:description" content="DurableSolutionsSimulation">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DurableSolutionsSimulation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Dry.html">Dry Data</a>
    </li>
    <li>
      <a href="../articles/Hargeisa.html">Simulation of IASC criteria - Somalia (Hargeisa)</a>
    </li>
    <li>
      <a href="../articles/Nigeria.html">Simulation of IASC criteria - Nigeria</a>
    </li>
    <li>
      <a href="../articles/intro.html">Towards a statistical measure for durable solutions to internal displacement: a simulation to assess indicator and metric choice</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Nigeria_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Simulation of IASC criteria - Nigeria</h1>
                        <h4 class="author">Sigrid Weber (<a href="mailto:sweber1@worldbank.org" class="email">sweber1@worldbank.org</a>)</h4>
            
            <h4 class="date">November 27, 2020</h4>
      
      
      <div class="hidden name"><code>Nigeria.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">##########################################################</span>
<span class="co"># Project: Simulation of IASC criteria - Nigeria</span>
<span class="co"># Author: Sigrid Weber (sweber1@worldbank.org)</span>
<span class="co"># Last updated: November 27, 2020</span>
<span class="co">##########################################################</span>


<span class="co"># preparations ---------------------------------------------------------</span>

<span class="co"># load required packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.3     ✓ purrr   0.3.4
## ✓ tibble  3.0.6     ✓ dplyr   1.0.4
## ✓ tidyr   1.1.2     ✓ stringr 1.4.0
## ✓ readr   1.4.0     ✓ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">doParallel</span><span class="op">)</span></code></pre></div>
<pre><code>## Loading required package: foreach</code></pre>
<pre><code>## 
## Attaching package: 'foreach'</code></pre>
<pre><code>## The following objects are masked from 'package:purrr':
## 
##     accumulate, when</code></pre>
<pre><code>## Loading required package: iterators</code></pre>
<pre><code>## Loading required package: parallel</code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/hrbrmstr/hrbrthemes">hrbrthemes</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">DurableSolutionsSimulation</span><span class="op">)</span>

<span class="co"># load functions</span>
<span class="co">#source("functions.R")</span>

<span class="co"># read data</span>
<span class="co">#nigeria &lt;- read_csv("Data/Nigeria.csv")</span>
<span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="fu">DurableSolutionsSimulation</span><span class="fu">::</span><span class="va"><a href="../reference/nigeria.html">nigeria</a></span>

<span class="co"># identify idps vs hosts</span>
<span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span> 
  <span class="fu">rename</span><span class="op">(</span>ID <span class="op">=</span> <span class="va">migr_idp</span><span class="op">)</span>

<span class="co"># identify potential IASC indicators for each subcriteria -------------</span></code></pre></div>
<div id="prepare-dataset-for-simulations" class="section level1">
<h1 class="hasAnchor">
<a href="#prepare-dataset-for-simulations" class="anchor"></a>Prepare dataset for simulations</h1>
<div id="victims-of-violence" class="section level2">
<h2 class="hasAnchor">
<a href="#victims-of-violence" class="anchor"></a>1.1 Victims of violence</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 1.1 Victims of violence</span>
<span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>
    <span class="co"># Proportion feeling very or moderately safe</span>
    I1_sec_saf <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
      <span class="va">H_4_1_safe_violence</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">H_4_1_safe_violence</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">H_4_1_safe_violence</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">~</span> <span class="fl">0</span>,
      <span class="va">H_4_1_safe_violence</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">~</span> <span class="fl">0</span>,
      <span class="va">H_4_1_safe_violence</span> <span class="op">==</span> <span class="fl">5</span> <span class="op">~</span> <span class="fl">0</span>,
      <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_real_</span><span class="op">)</span>,
    <span class="co"># Proportion feeling very or moderately safe walking at night</span>
    I1_sec_night <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
      <span class="va">H_4_2_safe_walking_night</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">H_4_2_safe_walking_night</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">H_4_2_safe_walking_night</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">~</span> <span class="fl">0</span>,
      <span class="va">H_4_2_safe_walking_night</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">~</span> <span class="fl">0</span>,
      <span class="va">H_4_2_safe_walking_night</span> <span class="op">==</span> <span class="fl">5</span> <span class="op">~</span> <span class="fl">0</span>,
      <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_real_</span><span class="op">)</span>,
    <span class="co"># Proportion feeling very or moderately safe walking during the day</span>
    I1_sec_day <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
      <span class="va">H_4_3_safe_walking_day</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">H_4_3_safe_walking_day</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">H_4_3_safe_walking_day</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">~</span> <span class="fl">0</span>,
      <span class="va">H_4_3_safe_walking_day</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">~</span> <span class="fl">0</span>,
      <span class="va">H_4_3_safe_walking_day</span> <span class="op">==</span> <span class="fl">5</span> <span class="op">~</span> <span class="fl">0</span>,
      <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_real_</span><span class="op">)</span>,
    
    <span class="co"># Proportion experiencing a security incident</span>
    I1_sec_inc  <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">nigeria</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"H_4_11"</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1</span><span class="op">)</span>,
    
    <span class="co"># Proportion experiencing and reporting a security incident</span>
    I1_sec_rep <span class="op">=</span> <span class="va">H_4_12_report_yn</span>,
    
    <span class="co"># Proportion accessing formal dispute resolution mechanisms</span>
    I1_sec_formal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">H_4_4_dispute_resolve</span> <span class="op">&gt;</span> <span class="fl">5</span> <span class="op">&amp;</span> <span class="va">H_4_4_dispute_resolve</span> <span class="op">&lt;</span> <span class="fl">1000</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,
    
    <span class="co"># Proportion finding it easy to access dispute resolution mechanisms</span>
    I1_sec_easy <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
      <span class="va">H_4_6_report_access</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">H_4_6_report_access</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">H_4_6_report_access</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">~</span> <span class="fl">0</span>,
      <span class="va">H_4_6_report_access</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">~</span> <span class="fl">0</span>,
      <span class="va">H_4_6_report_access</span> <span class="op">==</span> <span class="fl">5</span> <span class="op">~</span> <span class="fl">0</span>,
      <span class="va">H_4_7_report_challenge</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="fl">0</span>, 
      <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_real_</span><span class="op">)</span>,
    
    <span class="co"># Proportion finding dispute resolution effective</span>
    I1_sec_eff <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
      <span class="va">H_4_10_effective_disp</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">H_4_10_effective_disp</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">H_4_10_effective_disp</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">~</span> <span class="fl">0</span>,
      <span class="va">H_4_10_effective_disp</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">~</span> <span class="fl">0</span>,
      <span class="va">H_4_10_effective_disp</span> <span class="op">==</span> <span class="fl">5</span> <span class="op">~</span> <span class="fl">0</span>,
      <span class="va">H_4_10_effective_disp</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="fl">0</span>, 
      <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_real_</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
</div>
<div id="freedom-of-movement" class="section level2">
<h2 class="hasAnchor">
<a href="#freedom-of-movement" class="anchor"></a>1.2. Freedom of movement</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 1.2. Freedom of movement</span>
<span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>
    <span class="co"># Feeling free to move </span>
    I2_feel_free <span class="op">=</span> <span class="va">H_4_1_move_free</span>
  <span class="op">)</span></code></pre></div>
</div>
<div id="food-security" class="section level2">
<h2 class="hasAnchor">
<a href="#food-security" class="anchor"></a>2.1. Food security</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 2.1. Food security </span>
<span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span> 
  <span class="co"># Food insecurity scale</span>
  <span class="fu">mutate</span><span class="op">(</span>I3_food_insecurity_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span>
    <span class="va">nigeria</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C_4_1_nomoney"</span>,<span class="st">"C_4_2_cop_lessprefrerred"</span>,<span class="st">"C_4_3_cop_borrow_food"</span>,
              <span class="st">"C_4_4_cop_limitportion"</span>,<span class="st">"C_4_5_cop_limitadult"</span>,<span class="st">"C_4_6_cop_reducemeals"</span>,
              <span class="st">"C_4_7_cop_sellassets"</span>, <span class="st">"C_4_8_cop_sellfem"</span><span class="op">)</span><span class="op">]</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="shelter-and-housing" class="section level2">
<h2 class="hasAnchor">
<a href="#shelter-and-housing" class="anchor"></a>2.2 Shelter and housing</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 2.2 Shelter and housing </span>
<span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>
    
    <span class="co"># Proportion living in non-durable (incomplete, not intended, makeshift)</span>
    I4_hous_indurable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">C_1_1_housingtype</span> <span class="op">&gt;=</span> <span class="fl">11</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,
    
    <span class="co"># Proportion living in overcrowded shelter</span>
    I4_hous_overcrowd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">hhdensity_sl</span> <span class="op">&gt;</span> <span class="fl">1</span> , <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,
    
    <span class="co"># Proportion squatting</span>
    I4_hous_squat <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
      <span class="va">C_1_7_tenure</span> <span class="op">==</span> <span class="fl">2</span>  <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">C_1_7_tenure</span> <span class="op">==</span> <span class="fl">7</span>  <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">C_1_7_tenure</span> <span class="op">==</span> <span class="fl">8</span>  <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">C_1_7_tenure</span> <span class="op">==</span> <span class="fl">9</span>  <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">C_1_7_tenure</span> <span class="op">==</span> <span class="fl">1000</span>  <span class="op">~</span> <span class="cn">NA_real_</span>,
      <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">0</span><span class="op">)</span>, 
    
    <span class="co"># Proportion squatting or living in temporary shelter by UNHCR</span>
    I4_hous_temporary <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
      <span class="va">C_1_7_tenure</span> <span class="op">==</span> <span class="fl">1</span>  <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">C_1_7_tenure</span> <span class="op">==</span> <span class="fl">2</span>  <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">C_1_7_tenure</span> <span class="op">==</span> <span class="fl">7</span>  <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">C_1_7_tenure</span> <span class="op">==</span> <span class="fl">8</span>  <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">C_1_7_tenure</span> <span class="op">==</span> <span class="fl">9</span>  <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">C_1_7_tenure</span> <span class="op">==</span> <span class="fl">1000</span>  <span class="op">~</span> <span class="cn">NA_real_</span>,
      <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">0</span><span class="op">)</span>, 
    
    <span class="co"># Proportion owning or renting their housing</span>
    I4_hous_ownrent <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
      <span class="va">C_1_7_tenure</span> <span class="op">==</span> <span class="fl">5</span>  <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">C_1_7_tenure</span> <span class="op">==</span> <span class="fl">6</span>  <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">C_1_7_tenure</span> <span class="op">==</span> <span class="fl">1000</span>  <span class="op">~</span> <span class="cn">NA_real_</span>,
      <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">0</span><span class="op">)</span>,
    
    <span class="co"># Proportion owning or renting their land legally</span>
    I4_land_tenure <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
      <span class="va">C_3_1_land_access_yn</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="fl">0</span>,
      <span class="va">C_3_4_land_tenure</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">C_3_4_land_tenure</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="fl">2</span>,
      <span class="va">C_3_4_land_tenure</span> <span class="op">==</span> <span class="fl">1000</span>  <span class="op">~</span> <span class="fl">0</span>,
      <span class="va">C_3_4_land_tenure</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">~</span> <span class="fl">0</span>,
      <span class="va">C_3_4_land_tenure</span> <span class="op">==</span> <span class="fl">4</span>  <span class="op">~</span> <span class="fl">0</span>,
      <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_real_</span>
      <span class="op">)</span>,
    
    
    <span class="co"># Proportion getting their drinking water from improved sources </span>
    I4_hous_water <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">watersource</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,
    
    <span class="co"># Proportion facing no water obstacles</span>
    I4_hous_waccess <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">C_1_14_water_obstacle</span> <span class="op">==</span> <span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,
    
    
    <span class="co"># Proportion having access to improved sanitation facilities</span>
    I4_hous_toilet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">C_1_21_toilet</span><span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span>,<span class="fl">9</span><span class="op">)</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
</div>
<div id="medical-services" class="section level2">
<h2 class="hasAnchor">
<a href="#medical-services" class="anchor"></a>2.3 Medical services</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 2.3 Medical services </span>
<span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>
    
    <span class="co"># Proportion with access to essential health care when needed. </span>
    I5_med_access <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
      <span class="va">C_4_10_disease_yn</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">C_4_10_disease_yn</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">C_4_12_med_yn</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">C_4_10_disease_yn</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">C_4_12_med_yn</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="fl">0</span>,
      <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_real_</span><span class="op">)</span>,
    
    <span class="co"># Duration to next health facility (standardized)</span>
    I5_med_dist <span class="op">=</span> <span class="op">(</span><span class="va">thealth_d</span><span class="op">*</span><span class="fl">24</span><span class="op">)</span> <span class="op">+</span> <span class="va">thealth_h</span> <span class="op">+</span> <span class="op">(</span><span class="va">thealth_m</span><span class="op">/</span><span class="fl">60</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
</div>
<div id="education" class="section level2">
<h2 class="hasAnchor">
<a href="#education" class="anchor"></a>2.4 Education</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 2.4 Education</span>
<span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>
    <span class="co"># Duration to next education facility </span>
    I6_edu_dist <span class="op">=</span> <span class="op">(</span><span class="va">tedu_d</span><span class="op">*</span><span class="fl">24</span><span class="op">)</span> <span class="op">+</span> <span class="va">tedu_h</span> <span class="op">+</span> <span class="op">(</span><span class="va">tedu_m</span><span class="op">/</span><span class="fl">60</span><span class="op">)</span>,
    
    <span class="co"># Proportion satisfied with school</span>
    I6_edu_satis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">H_2_7_school_satisfaction</span> <span class="op">%in%</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
</div>
<div id="employment-and-livelihoods" class="section level2">
<h2 class="hasAnchor">
<a href="#employment-and-livelihoods" class="anchor"></a>3.1 Employment and livelihoods</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 3.1 Employment and livelihoods</span>
<span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>
    <span class="co">#  Proportion whose income is generated from wages, salaries, own business or pension</span>
    I7_salary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">C_5_1_lhood</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">8</span><span class="op">)</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
</div>
<div id="economic-security" class="section level2">
<h2 class="hasAnchor">
<a href="#economic-security" class="anchor"></a>3.2 Economic security</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 3.2 Economic security </span>
<span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>
    <span class="co"># Proportion below 1.9 USD PPP 2011 Poverty Line</span>
    I8_poor <span class="op">=</span> <span class="va">poor</span>, 
    
    <span class="co"># Proportion Below 1.25 USD PPP 2011 poverty line</span>
    I8_poor125 <span class="op">=</span> <span class="va">poor125</span>, 
    
    <span class="co"># Proportion Below 3.1 USD PPP 2011 poverty line</span>
    I8_poor31 <span class="op">=</span> <span class="va">poor31</span>, 
    
    <span class="co"># Ratio of food vs total consumption</span>
    I8_foodtotal <span class="op">=</span> <span class="va">mi_cons_f</span><span class="op">/</span><span class="va">tc_imp</span>,
    
    <span class="co"># Proportion consuming more than average</span>
    I8_consume <span class="op">=</span> <span class="va">tc_imp</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">tc_imp</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,
    
    <span class="co"># Proportion having a bank account</span>
    I8_bank <span class="op">=</span> <span class="va">C_4_15_bank_account</span>,
    
    <span class="co"># Distance to market</span>
    I8_market_dist <span class="op">=</span> <span class="op">(</span><span class="va">tmarket_d</span><span class="op">*</span><span class="fl">24</span><span class="op">)</span> <span class="op">+</span> <span class="va">tmarket_h</span> <span class="op">+</span> <span class="op">(</span><span class="va">tmarket_m</span><span class="op">/</span><span class="fl">60</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
</div>
<div id="property-restitution-and-compensation" class="section level2">
<h2 class="hasAnchor">
<a href="#property-restitution-and-compensation" class="anchor"></a>4.1 Property restitution and compensation</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 4.1 Property restitution and compensation </span>
<span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>
    <span class="co"># Proportion being legally recognized owner of dwelling</span>
    I9_hlp_right <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
      <span class="va">tenure</span> <span class="op">==</span> <span class="fl">6</span> <span class="op">&amp;</span> <span class="va">C_1_9_land_legal_main</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">tenure</span> <span class="op">==</span> <span class="fl">6</span> <span class="op">&amp;</span> <span class="va">C_1_9_land_legal_main</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="fl">0</span>,
      <span class="va">tenure</span> <span class="op">!=</span> <span class="fl">6</span> <span class="op">~</span> <span class="fl">0</span>,
      <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_real_</span><span class="op">)</span>,
    
    <span class="co"># Proportion having access to compensation mechanisms</span>
    I9_hlp_compensation <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
      <span class="va">ID</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">ID</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">H_2_11_legal_access_disp</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">ID</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">H_2_11_legal_access_disp</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="fl">0</span>,
      <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_real_</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
</div>
<div id="documentation" class="section level2">
<h2 class="hasAnchor">
<a href="#documentation" class="anchor"></a>5.1. Documentation</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 5.1. Documentation </span>
<span class="va">nigeria</span>  <span class="op">&lt;-</span> <span class="va">nigeria</span>  <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>
    
    <span class="co"># Proportion with documents or access to replace missing documents if lost</span>
    I10_doc_replace <span class="op">=</span>  <span class="fu">case_when</span><span class="op">(</span>
      <span class="va">ID</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">H_2_9_legal_id_disp</span><span class="op">)</span> <span class="op">==</span> <span class="cn">T</span> <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">H_2_9_legal_id_disp</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">H_2_9_legal_id_disp</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">H_2_10_legal_id_acc_disp</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">H_2_9_legal_id_disp</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">H_2_10_legal_id_acc_disp</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="fl">0</span>,
      <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_real_</span><span class="op">)</span>
    
  <span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># prepare dataset for simulations -----------------------------------------------</span>

<span class="co"># select variables</span>
<span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">ID</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"I"</span><span class="op">)</span>, <span class="op">-</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"I_"</span><span class="op">)</span>,
                              <span class="va">region</span>, 
                              <span class="va">I_1_3_disp_date</span>, 
                              <span class="va">I_1_7_disp_arrive_date</span>,
                              <span class="va">I_1_1_disp_from</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">rename</span><span class="op">(</span>disp_date <span class="op">=</span>  <span class="va">I_1_3_disp_date</span>,
         arriv_date <span class="op">=</span> <span class="va">I_1_7_disp_arrive_date</span>,
         origin <span class="op">=</span> <span class="va">I_1_1_disp_from</span><span class="op">)</span>


<span class="co"># unify direction of indicators: 1 for passing </span>
<span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>
    I1_sec_saf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I1_sec_saf</span> <span class="op">&gt;=</span> <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,
    I1_sec_night <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I1_sec_night</span> <span class="op">&gt;=</span> <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,
    I1_sec_day <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I1_sec_day</span> <span class="op">&gt;=</span> <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,
    I1_sec_inc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I1_sec_inc</span> <span class="op">&lt;=</span> <span class="fl">0</span>, <span class="fl">1</span> ,<span class="fl">0</span><span class="op">)</span>,
    I1_sec_rep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I1_sec_rep</span> <span class="op">&gt;=</span> <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,
    I1_sec_formal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I1_sec_formal</span> <span class="op">&gt;=</span> <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,
    I1_sec_easy<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I1_sec_easy</span> <span class="op">&gt;=</span> <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,
    I1_sec_eff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I1_sec_eff</span> <span class="op">&gt;=</span> <span class="fl">1</span>,<span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,
    I2_feel_free <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I2_feel_free</span> <span class="op">&gt;=</span> <span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,
    I3_food_insecurity_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I3_food_insecurity_scale</span><span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">I3_food_insecurity_scale</span>,na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, 
    I4_hous_indurable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I4_hous_indurable</span> <span class="op">&lt;=</span> <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,
    I4_hous_overcrowd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I4_hous_overcrowd</span> <span class="op">&lt;=</span> <span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,
    I4_hous_squat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I4_hous_squat</span> <span class="op">&lt;=</span> <span class="fl">0</span>, <span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,
    I4_hous_temporary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I4_hous_temporary</span> <span class="op">&lt;=</span> <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,
    I4_hous_ownrent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I4_hous_ownrent</span> <span class="op">&gt;=</span> <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,
    I4_land_tenure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I4_land_tenure</span> <span class="op">&gt;=</span> <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,
    I4_hous_water <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I4_hous_water</span> <span class="op">&gt;=</span> <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,
    I4_hous_waccess <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I4_hous_waccess</span> <span class="op">&gt;=</span> <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,
    I4_hous_toilet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I4_hous_toilet</span> <span class="op">&gt;=</span> <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,
    I5_med_access <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I5_med_access</span> <span class="op">&gt;=</span> <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,
    I5_med_dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I5_med_dist</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">I5_med_dist</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, 
    I6_edu_dist<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I6_edu_dist</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">I6_edu_dist</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, 
    I6_edu_satis<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I6_edu_satis</span> <span class="op">&gt;=</span> <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,
    I7_salary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I7_salary</span> <span class="op">&gt;=</span> <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,
    I8_poor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I8_poor</span> <span class="op">&lt;=</span> <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,
    I8_poor31  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I8_poor31</span> <span class="op">&lt;=</span> <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,
    I8_poor125  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I8_poor125</span> <span class="op">&lt;=</span> <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,
    I8_foodtotal<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I8_foodtotal</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">I8_foodtotal</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, 
    I8_consume <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span> <span class="va">I8_consume</span><span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">I8_consume</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,
    I8_bank  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I8_bank</span> <span class="op">&gt;=</span> <span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,  
    I8_market_dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I8_market_dist</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">I8_market_dist</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,
    I9_hlp_right <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I9_hlp_right</span> <span class="op">&gt;=</span> <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,
    I9_hlp_compensation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I9_hlp_compensation</span> <span class="op">&gt;=</span> <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,
    I10_doc_replace<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">I10_doc_replace</span> <span class="op">&gt;=</span> <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span>

<span class="co"># save a version for later use in script</span>
<span class="va">nigeria_raw</span> <span class="op">&lt;-</span> <span class="va">nigeria</span>

<span class="co"># divide into IDPs and benchmark</span>
<span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">ID</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"I"</span><span class="op">)</span>, <span class="op">-</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"I_"</span><span class="op">)</span><span class="op">)</span>
<span class="va">benchmarks</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>

<span class="co"># see for how many no assessment is possible</span>
<span class="fu">naniar</span><span class="fu">::</span><span class="fu"><a href="http://visdat.njtierney.com//reference/vis_miss.html">vis_miss</a></span><span class="op">(</span><span class="va">nigeria</span><span class="op">)</span></code></pre></div>
<p><img src="Nigeria_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
</div>
<div id="simulations" class="section level1">
<h1 class="hasAnchor">
<a href="#simulations" class="anchor"></a>SIMULATIONS</h1>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># SIMULATIONS ############################################</span>

<span class="co"># Original framework ----------------------------------------------------------</span>

<span class="co"># define the indicators</span>
<span class="va">indicators</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  I1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nigeria</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"I1_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  I2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nigeria</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"I2_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  I3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nigeria</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"I3_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  I4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nigeria</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"I4_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  I5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nigeria</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"I5_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  I6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nigeria</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"I6_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  I7 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nigeria</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"I7_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  I8 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nigeria</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"I8_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  I9 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nigeria</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"I9_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  I10 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nigeria</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"I10_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># identify all possible combinations</span>
<span class="va">combinations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span><span class="va">indicators</span><span class="op">)</span><span class="op">%&gt;%</span> 
  <span class="fu">mutate_all</span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="according-to-iris-framework" class="section level2">
<h2 class="hasAnchor">
<a href="#according-to-iris-framework" class="anchor"></a>According to IRIS framework</h2>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Identify durable solution according to IRIS framework</span>
<span class="va">Durable_Solutions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">combinations</span><span class="op">)</span>,
                            data <span class="op">=</span> <span class="va">nigeria</span>, <span class="co"># Dataset</span>
                            sim_data <span class="op">=</span> <span class="va">combinations</span>, <span class="co"># Dataset of possible indicator combinations</span>
                            <span class="fu">DurableSolutionsSimulation</span><span class="fu">::</span><span class="va"><a href="../reference/use_IRIS_metric.html">use_IRIS_metric</a></span> <span class="co"># Function</span>
                            <span class="op">)</span>

<span class="co"># Save for analysis and plotting</span>
<span class="va">DS_original</span> <span class="op">&lt;-</span> <span class="va">combinations</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>DS <span class="op">=</span> <span class="va">Durable_Solutions</span>,
         DS_perc <span class="op">=</span> <span class="va">DS</span><span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">nigeria</span><span class="op">)</span><span class="op">)</span>


<span class="co"># Plot result </span>
<span class="va">plot_original</span> <span class="op">&lt;-</span> <span class="va">DS_original</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">DS_perc</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_density</span><span class="op">(</span>fill<span class="op">=</span><span class="st">"#0073C2FF"</span>, color<span class="op">=</span><span class="st">"#e9ecef"</span>, alpha<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/hrbrthemes/man/theme_ipsum.html">theme_ipsum</a></span><span class="op">(</span>plot_title_size <span class="op">=</span> <span class="fl">13</span>, base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_vline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DS_perc</span><span class="op">)</span><span class="op">)</span>, 
             linetype <span class="op">=</span> <span class="st">"dashed"</span>, size <span class="op">=</span> <span class="fl">0.6</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Pass/fail measure"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Simulated proportion overcoming vulnerabilities"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Simulation density"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span>

<span class="va">plot_original</span></code></pre></div>
<p><img src="Nigeria_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="op">(</span><span class="va">DS_perc</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span> <span class="op">~</span> <span class="va">I1</span> <span class="op">+</span> <span class="va">I4</span><span class="op">+</span><span class="va">I5</span><span class="op">+</span><span class="va">I6</span> <span class="op">+</span> <span class="va">I8</span><span class="op">+</span><span class="va">I9</span>, data<span class="op">=</span> <span class="va">DS_original</span><span class="op">)</span><span class="op">)</span>
<span class="va">model</span> <span class="op">&lt;-</span> <span class="va">model</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">estimate</span> <span class="op">-</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">std.error</span><span class="op">)</span>,
         ymax <span class="op">=</span> <span class="va">estimate</span> <span class="op">+</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">std.error</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">term</span> <span class="op">!=</span> <span class="st">"(Intercept)"</span><span class="op">)</span></code></pre></div>
</div>
<div id="option-1-full-composite" class="section level2">
<h2 class="hasAnchor">
<a href="#option-1-full-composite" class="anchor"></a>Option 1: Full composite</h2>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Option 1: Full composite ---------------------------------------------------</span>

<span class="va">Durable_Solutions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">combinations</span><span class="op">)</span>,
                            data <span class="op">=</span> <span class="va">nigeria</span>,
                            sim_data <span class="op">=</span> <span class="va">combinations</span>,
                            benchmark <span class="op">=</span> <span class="va">benchmarks</span>,
                            <span class="fu">DurableSolutionsSimulation</span><span class="fu">::</span><span class="va"><a href="../reference/use_composite.html">use_composite</a></span><span class="op">)</span>

<span class="va">DS_option1</span> <span class="op">&lt;-</span> <span class="va">combinations</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>DS <span class="op">=</span> <span class="va">Durable_Solutions</span>,
         DS_perc <span class="op">=</span> <span class="va">DS</span><span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">nigeria</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Plot result </span>
<span class="va">plot_option1</span> <span class="op">&lt;-</span> <span class="va">DS_option1</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">DS_perc</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_density</span><span class="op">(</span>fill<span class="op">=</span><span class="st">"#0073C2FF"</span>, color<span class="op">=</span><span class="st">"#e9ecef"</span>, alpha<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/hrbrthemes/man/theme_ipsum.html">theme_ipsum</a></span><span class="op">(</span>plot_title_size <span class="op">=</span> <span class="fl">13</span>, base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_vline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DS_perc</span><span class="op">)</span><span class="op">)</span>, 
             linetype <span class="op">=</span> <span class="st">"dashed"</span>, size <span class="op">=</span> <span class="fl">0.6</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"1: Full composite"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Simulated proportion overcoming vulnerabilities"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Simulation density"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.6</span><span class="op">)</span>

<span class="va">plot_option1</span></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_density).</code></pre>
<p><img src="Nigeria_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="op">(</span><span class="va">DS_perc</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span> <span class="op">~</span> <span class="va">I1</span><span class="op">+</span><span class="va">I4</span><span class="op">+</span><span class="va">I5</span><span class="op">+</span><span class="va">I6</span><span class="op">+</span><span class="va">I8</span><span class="op">+</span><span class="va">I9</span>, data<span class="op">=</span> <span class="va">DS_option1</span><span class="op">)</span><span class="op">)</span>
<span class="va">model1</span> <span class="op">&lt;-</span> <span class="va">model1</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">estimate</span> <span class="op">-</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">std.error</span><span class="op">)</span>,
         ymax <span class="op">=</span> <span class="va">estimate</span> <span class="op">+</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">std.error</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">term</span> <span class="op">!=</span> <span class="st">"(Intercept)"</span><span class="op">)</span></code></pre></div>
</div>
<div id="option-2-composite-indices-at-the-criterion-level" class="section level2">
<h2 class="hasAnchor">
<a href="#option-2-composite-indices-at-the-criterion-level" class="anchor"></a>Option 2: composite indices at the criterion level</h2>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Option 2: composite indices at the criterion level ###########################################</span>

<span class="va">Durable_Solutions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">combinations</span><span class="op">)</span>,
                            data <span class="op">=</span> <span class="va">nigeria</span>,
                            sim_data <span class="op">=</span> <span class="va">combinations</span>,
                            benchmark <span class="op">=</span> <span class="va">benchmarks</span>,
                            <span class="fu">DurableSolutionsSimulation</span><span class="fu">::</span><span class="va"><a href="../reference/use_criterion.html">use_criterion</a></span><span class="op">)</span>

<span class="va">DS_option2</span> <span class="op">&lt;-</span> <span class="va">combinations</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>DS <span class="op">=</span> <span class="va">Durable_Solutions</span>,
         DS_perc <span class="op">=</span> <span class="va">DS</span><span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">nigeria</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Plot result </span>
<span class="va">plot_option2</span> <span class="op">&lt;-</span> <span class="va">DS_option2</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">DS_perc</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_density</span><span class="op">(</span>fill<span class="op">=</span><span class="st">"#0073C2FF"</span>, color<span class="op">=</span><span class="st">"#e9ecef"</span>, alpha<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/hrbrthemes/man/theme_ipsum.html">theme_ipsum</a></span><span class="op">(</span>plot_title_size <span class="op">=</span> <span class="fl">13</span>, base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_vline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DS_perc</span><span class="op">)</span><span class="op">)</span>, 
             linetype <span class="op">=</span> <span class="st">"dashed"</span>, size <span class="op">=</span> <span class="fl">0.6</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"2: Composite at criterion level"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Simulated proportion overcoming vulnerabilities"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Simulation density"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span>

<span class="va">plot_option2</span></code></pre></div>
<p><img src="Nigeria_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="op">(</span><span class="va">DS_perc</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span> <span class="op">~</span> <span class="va">I1</span><span class="op">+</span><span class="va">I4</span><span class="op">+</span><span class="va">I5</span><span class="op">+</span><span class="va">I6</span><span class="op">+</span><span class="va">I8</span><span class="op">+</span><span class="va">I9</span>, data<span class="op">=</span> <span class="va">DS_option2</span><span class="op">)</span><span class="op">)</span>
<span class="va">model2</span> <span class="op">&lt;-</span> <span class="va">model2</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">estimate</span> <span class="op">-</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">std.error</span><span class="op">)</span>,
         ymax <span class="op">=</span> <span class="va">estimate</span> <span class="op">+</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">std.error</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">term</span> <span class="op">!=</span> <span class="st">"(Intercept)"</span><span class="op">)</span> </code></pre></div>
</div>
<div id="option-3-composite-indices-at-the-subcriterion-level" class="section level2">
<h2 class="hasAnchor">
<a href="#option-3-composite-indices-at-the-subcriterion-level" class="anchor"></a>Option 3: composite indices at the subcriterion level</h2>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Option 3: composite indices at the subcriterion level ###########################################</span>

<span class="co"># define indices for the levels with few indicators available</span>
<span class="va">nigeria</span> <span class="op">&lt;-</span> <span class="va">nigeria</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>I2 <span class="op">=</span> <span class="va">I2_feel_free</span>,
         I3 <span class="op">=</span> <span class="va">I3_food_insecurity_scale</span>,
         I5 <span class="op">=</span> <span class="va">I5_med_access</span> <span class="op">+</span> <span class="va">I5_med_dist</span>, 
         I6 <span class="op">=</span> <span class="va">I6_edu_dist</span><span class="op">+</span><span class="va">I6_edu_satis</span>,
         I7 <span class="op">=</span> <span class="va">I7_salary</span>,
         I9 <span class="op">=</span> <span class="va">I9_hlp_right</span> <span class="op">+</span> <span class="va">I9_hlp_compensation</span>,
         I10 <span class="op">=</span> <span class="va">I10_doc_replace</span><span class="op">)</span>

<span class="va">benchmarks</span> <span class="op">&lt;-</span> <span class="va">benchmarks</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>I2 <span class="op">=</span> <span class="va">I2_feel_free</span>,
         I3 <span class="op">=</span> <span class="va">I3_food_insecurity_scale</span>,
         I5 <span class="op">=</span> <span class="va">I5_med_access</span> <span class="op">+</span> <span class="va">I5_med_dist</span>, 
         I6 <span class="op">=</span> <span class="va">I6_edu_dist</span><span class="op">+</span><span class="va">I6_edu_satis</span>,
         I7 <span class="op">=</span> <span class="va">I7_salary</span>,
         I9 <span class="op">=</span> <span class="va">I9_hlp_right</span> <span class="op">+</span> <span class="va">I9_hlp_compensation</span>,
         I10 <span class="op">=</span> <span class="va">I10_doc_replace</span><span class="op">)</span>


<span class="co"># define the new indicators</span>
<span class="va">indicators_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  index1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/combn.html">combn</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nigeria</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"I1_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span>,<span class="fl">1</span>, <span class="va">paste</span>,collapse<span class="op">=</span> <span class="st">";"</span><span class="op">)</span>,
  index4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/combn.html">combn</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nigeria</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"I4_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span>,<span class="fl">1</span>, <span class="va">paste</span>,collapse<span class="op">=</span> <span class="st">";"</span><span class="op">)</span>,
  index8 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/combn.html">combn</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nigeria</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"I8_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span>,<span class="fl">1</span>, <span class="va">paste</span>,collapse<span class="op">=</span> <span class="st">";"</span><span class="op">)</span>
  <span class="op">)</span>


<span class="co"># define the new combinations</span>
<span class="va">combinations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span><span class="va">indicators_sub</span><span class="op">)</span><span class="op">%&gt;%</span> 
  <span class="fu">mutate_all</span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">separate</span><span class="op">(</span>col <span class="op">=</span> <span class="va">index1</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"I1_Index_1"</span>, <span class="st">"I1_Index_2"</span>,<span class="st">"I1_Index_3"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">";"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">separate</span><span class="op">(</span>col <span class="op">=</span> <span class="va">index4</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"I4_Index_1"</span>, <span class="st">"I4_Index_2"</span>,<span class="st">"I4_Index_3"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">";"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">separate</span><span class="op">(</span>col <span class="op">=</span> <span class="va">index8</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"I8_Index_1"</span>, <span class="st">"I8_Index_2"</span>,<span class="st">"I8_Index_3"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">";"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>I2 <span class="op">=</span> <span class="st">"I2"</span>,I3 <span class="op">=</span> <span class="st">"I3"</span>,I5 <span class="op">=</span> <span class="st">"I5"</span>, I6 <span class="op">=</span> <span class="st">"I6"</span>,I7 <span class="op">=</span> <span class="st">"I7"</span>, I9 <span class="op">=</span> <span class="st">"I9"</span>, I10 <span class="op">=</span> <span class="st">"I10"</span><span class="op">)</span>


<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span>
<span class="va">combinations</span> <span class="op">&lt;-</span> <span class="fu">sample_n</span><span class="op">(</span><span class="va">combinations</span>, <span class="fl">10000</span><span class="op">)</span>

<span class="co"># run parallel as otherwise slow</span>
<span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html">makeCluster</a></span><span class="op">(</span><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html">registerDoParallel</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span>
<span class="va">Durable_Solutions</span> <span class="op">&lt;-</span> <span class="fu">foreach</span><span class="op">(</span>i <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">combinations</span><span class="op">)</span>, 
                             .packages <span class="op">=</span> <span class="st">"tidyverse"</span><span class="op">)</span> <span class="op">%dopar%</span> <span class="op">{</span>
                               <span class="fu">DurableSolutionsSimulation</span><span class="fu">::</span><span class="fu"><a href="../reference/use_subcriterion.html">use_subcriterion</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">i</span>,
                                                data <span class="op">=</span> <span class="va">nigeria</span>,
                                                sim_data <span class="op">=</span> <span class="va">combinations</span>,
                                                benchmark <span class="op">=</span> <span class="va">benchmarks</span><span class="op">)</span>
                             <span class="op">}</span>

<span class="fu">stopCluster</span><span class="op">(</span><span class="va">cl</span><span class="op">)</span>

<span class="va">Durable_Solutions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">Durable_Solutions</span><span class="op">)</span>
<span class="va">DS_option3</span> <span class="op">&lt;-</span> <span class="va">combinations</span> <span class="op">%&gt;%</span> 
              <span class="fu">mutate</span><span class="op">(</span>DS <span class="op">=</span> <span class="va">Durable_Solutions</span>,
                     DS_perc <span class="op">=</span> <span class="va">DS</span><span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">nigeria</span><span class="op">)</span><span class="op">)</span>


<span class="co"># Plot result </span>
<span class="va">plot_option3</span> <span class="op">&lt;-</span> <span class="va">DS_option3</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">DS_perc</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_density</span><span class="op">(</span>fill<span class="op">=</span><span class="st">"#0073C2FF"</span>, color<span class="op">=</span><span class="st">"#e9ecef"</span>, alpha<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/hrbrthemes/man/theme_ipsum.html">theme_ipsum</a></span><span class="op">(</span>plot_title_size <span class="op">=</span> <span class="fl">13</span>, base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_vline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DS_perc</span><span class="op">)</span><span class="op">)</span>, 
             linetype <span class="op">=</span> <span class="st">"dashed"</span>, size <span class="op">=</span> <span class="fl">0.6</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"3: Composite at sub-criterion level"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Simulated proportion overcoming vulnerabilities"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Simulation density"</span><span class="op">)</span>
<span class="va">plot_option3</span></code></pre></div>
<p><img src="Nigeria_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
<div id="option-4-comparison-of-homogenous-cells" class="section level2">
<h2 class="hasAnchor">
<a href="#option-4-comparison-of-homogenous-cells" class="anchor"></a>Option 4: Comparison of homogenous cells</h2>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Option 4: Comparison of homogenous cells ###########################################</span>

<span class="va">cells</span> <span class="op">&lt;-</span> <span class="va">nigeria_raw</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>disp_month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">disp_date</span><span class="op">==</span> <span class="st">"N/A"</span>,<span class="cn">NA</span>,<span class="va">disp_date</span><span class="op">)</span>, start<span class="op">=</span><span class="fl">1</span>,stop<span class="op">=</span><span class="fl">7</span><span class="op">)</span>,
         disp_year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">disp_date</span><span class="op">==</span> <span class="st">"N/A"</span>,<span class="cn">NA</span>,<span class="va">disp_date</span><span class="op">)</span>, start<span class="op">=</span><span class="fl">1</span>,stop<span class="op">=</span><span class="fl">4</span><span class="op">)</span>,
         arriv_month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">arriv_date</span><span class="op">==</span> <span class="st">"N/A"</span>,<span class="cn">NA</span>,<span class="va">arriv_date</span><span class="op">)</span>, start<span class="op">=</span><span class="fl">1</span>,stop<span class="op">=</span><span class="fl">7</span><span class="op">)</span>,
         arriv_year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">arriv_date</span><span class="op">==</span> <span class="st">"N/A"</span>,<span class="cn">NA</span>,<span class="va">arriv_date</span><span class="op">)</span>, start<span class="op">=</span><span class="fl">1</span>,stop<span class="op">=</span><span class="fl">4</span><span class="op">)</span>,
         origin <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
           <span class="va">origin</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"Same ward"</span>,
           <span class="va">origin</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="st">"Same local government area"</span>,
           <span class="va">origin</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">~</span> <span class="st">"Same state"</span>,
           <span class="va">origin</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">~</span> <span class="st">"Different state in Nigeria"</span>,
           <span class="va">origin</span> <span class="op">==</span> <span class="fl">5</span> <span class="op">~</span> <span class="st">"Outside Nigeria"</span>,
           <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_character_</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">disp_date</span>,<span class="op">-</span><span class="va">arriv_date</span><span class="op">)</span>

<span class="va">benchmarks</span> <span class="op">&lt;-</span> <span class="va">cells</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"I"</span><span class="op">)</span>, <span class="op">-</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"I_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise_all</span><span class="op">(</span><span class="va">.</span>,<span class="va">mean</span>,na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>

<span class="va">cell_options</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  arriv_date_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"arriv_year"</span>,<span class="st">"arriv_month"</span><span class="op">)</span>,
  disp_date_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"disp_year"</span>,<span class="st">"disp_month"</span><span class="op">)</span>,
  location_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"region"</span>, <span class="st">"origin"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># identify all possible combinations</span>
<span class="va">combinations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span><span class="va">cell_options</span><span class="op">)</span><span class="op">%&gt;%</span> 
  <span class="fu">mutate_all</span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span>

<span class="va">combinations1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span><span class="va">indicators</span><span class="op">)</span><span class="op">%&gt;%</span> 
  <span class="fu">mutate_all</span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span>

<span class="co"># run simulation</span>
<span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html">makeCluster</a></span><span class="op">(</span><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html">registerDoParallel</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span>

<span class="va">Durable_Solutions</span> <span class="op">&lt;-</span> <span class="fu">foreach</span><span class="op">(</span>i <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">combinations1</span><span class="op">)</span>, .packages <span class="op">=</span> <span class="st">"tidyverse"</span><span class="op">)</span> <span class="op">%dopar%</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">combinations</span><span class="op">)</span>,
         y<span class="op">=</span><span class="va">i</span>,
         data <span class="op">=</span> <span class="va">cells</span>, 
         combination_cells<span class="op">=</span> <span class="va">combinations</span>,
         combination_indicators<span class="op">=</span><span class="va">combinations1</span>,
         benchmark<span class="op">=</span> <span class="va">benchmarks</span>,
         <span class="fu">DurableSolutionsSimulation</span><span class="fu">::</span><span class="va"><a href="../reference/use_cells.html">use_cells</a></span><span class="op">)</span>
<span class="op">}</span>

<span class="fu">stopCluster</span><span class="op">(</span><span class="va">cl</span><span class="op">)</span>

<span class="co"># make the indicators dataframe</span>
<span class="va">DS_option4_ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">Durable_Solutions</span><span class="op">)</span>, 
                                   nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Durable_Solutions</span><span class="op">)</span>, 
                                   byrow<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">DS_option4_ind</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"DS_"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span>

<span class="va">DS_option4_ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">combinations1</span>,<span class="va">DS_option4_ind</span><span class="op">)</span>
<span class="va">DS_option4_ind</span> <span class="op">&lt;-</span> <span class="va">DS_option4_ind</span> <span class="op">%&gt;%</span> 
  <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">.</span>,cols<span class="op">=</span> <span class="fu">starts_with</span><span class="op">(</span><span class="st">"DS_"</span><span class="op">)</span>,values_to <span class="op">=</span> <span class="st">"DS"</span>, names_to <span class="op">=</span> <span class="st">"iteration"</span><span class="op">)</span><span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span> DS_perc <span class="op">=</span> <span class="va">DS</span><span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">nigeria</span><span class="op">)</span><span class="op">)</span>

<span class="co"># make the cell indicator dataframe</span>
<span class="va">DS_option4_cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>
  <span class="va">combinations</span>, 
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">Durable_Solutions</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">8</span>, byrow<span class="op">=</span><span class="cn">F</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> 

<span class="va">DS_option4_cells</span> <span class="op">&lt;-</span> <span class="va">DS_option4_cells</span><span class="op">%&gt;%</span> 
  <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">.</span>,cols<span class="op">=</span> <span class="fu">starts_with</span><span class="op">(</span><span class="st">"X"</span><span class="op">)</span>,values_to <span class="op">=</span> <span class="st">"DS"</span>, names_to <span class="op">=</span> <span class="st">"iteration"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span> DS_perc <span class="op">=</span> <span class="va">DS</span><span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">nigeria</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Plot result </span>
<span class="va">plot_option4</span> <span class="op">&lt;-</span> <span class="va">DS_option4_cells</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">DS_perc</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_density</span><span class="op">(</span>fill<span class="op">=</span><span class="st">"#0073C2FF"</span>, color<span class="op">=</span><span class="st">"#e9ecef"</span>, alpha<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/hrbrthemes/man/theme_ipsum.html">theme_ipsum</a></span><span class="op">(</span>plot_title_size <span class="op">=</span> <span class="fl">13</span>, base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_vline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DS_perc</span><span class="op">)</span><span class="op">)</span>, 
             linetype <span class="op">=</span> <span class="st">"dashed"</span>, size <span class="op">=</span> <span class="fl">0.6</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"4: Comparison of homogenous cells"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Simulated proportion overcoming vulnerabilities"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Simulation density"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span>
<span class="va">plot_option4</span></code></pre></div>
<p><img src="Nigeria_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Check impact of indicators</span>
<span class="va">model4</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="op">(</span><span class="va">DS_perc</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span> <span class="op">~</span> <span class="va">I1</span><span class="op">+</span><span class="va">I4</span><span class="op">+</span><span class="va">I5</span><span class="op">+</span><span class="va">I6</span><span class="op">+</span><span class="va">I8</span><span class="op">+</span><span class="va">I9</span>, data<span class="op">=</span> <span class="va">DS_option4_ind</span><span class="op">)</span><span class="op">)</span>
<span class="va">model4</span> <span class="op">&lt;-</span> <span class="va">model4</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">estimate</span> <span class="op">-</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">std.error</span><span class="op">)</span>,
         ymax <span class="op">=</span> <span class="va">estimate</span> <span class="op">+</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">std.error</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">term</span> <span class="op">!=</span> <span class="st">"(Intercept)"</span><span class="op">)</span> </code></pre></div>
</div>
<div id="option-5-use-a-classifier" class="section level2">
<h2 class="hasAnchor">
<a href="#option-5-use-a-classifier" class="anchor"></a>Option 5: Use a classifier</h2>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Option 5: Use a classifier ------------------------------------------------------------</span>

<span class="co"># define the indicators</span>
<span class="va">indicators</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  I1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nigeria_raw</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"I1_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  I2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nigeria_raw</span>  <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"I2_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  I3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nigeria_raw</span>  <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"I3_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  I4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nigeria_raw</span>  <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"I4_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  I5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nigeria_raw</span>  <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"I5_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  I6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nigeria_raw</span>  <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"I6_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  I7 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nigeria_raw</span>  <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"I7_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  I8 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nigeria_raw</span>  <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"I8_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  I9 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nigeria_raw</span>  <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"I9_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  I10 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nigeria_raw</span>  <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"I10_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>


<span class="co"># identify all possible combinations</span>
<span class="va">combinations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span><span class="va">indicators</span><span class="op">)</span><span class="op">%&gt;%</span> 
  <span class="fu">mutate_all</span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Identify durable solution </span>
<span class="co"># run parallel as otherwise slow</span>
<span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html">makeCluster</a></span><span class="op">(</span><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html">registerDoParallel</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span>
<span class="va">Durable_Solutions</span> <span class="op">&lt;-</span> <span class="fu">foreach</span><span class="op">(</span>i <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">combinations</span><span class="op">)</span>, 
                             .packages <span class="op">=</span> <span class="st">"tidyverse"</span><span class="op">)</span> <span class="op">%dopar%</span> <span class="op">{</span>
                               <span class="fu">DurableSolutionsSimulation</span><span class="fu">::</span><span class="fu"><a href="../reference/use_classifier.html">use_classifier</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">i</span>,
                                              data <span class="op">=</span> <span class="va">nigeria_raw</span>,
                                              sim_data <span class="op">=</span> <span class="va">combinations</span><span class="op">)</span>
                             <span class="op">}</span>

<span class="fu">stopCluster</span><span class="op">(</span><span class="va">cl</span><span class="op">)</span>

<span class="va">Durable_Solutions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">Durable_Solutions</span><span class="op">)</span>

<span class="co"># Save for analysis and plotting</span>
<span class="va">DS_Option5</span> <span class="op">&lt;-</span> <span class="va">combinations</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>DS <span class="op">=</span> <span class="va">Durable_Solutions</span>,
         DS_perc <span class="op">=</span> <span class="va">DS</span><span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">nigeria</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Plot result </span>
<span class="va">plot_option5</span> <span class="op">&lt;-</span> <span class="va">DS_Option5</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">DS_perc</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_density</span><span class="op">(</span>fill<span class="op">=</span><span class="st">"#0073C2FF"</span>, color<span class="op">=</span><span class="st">"#e9ecef"</span>, alpha<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/hrbrthemes/man/theme_ipsum.html">theme_ipsum</a></span><span class="op">(</span>plot_title_size <span class="op">=</span> <span class="fl">13</span>, base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_vline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DS_perc</span><span class="op">)</span><span class="op">)</span>, 
             linetype <span class="op">=</span> <span class="st">"dashed"</span>, size <span class="op">=</span> <span class="fl">0.6</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"5: Classifier/ regression-based"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Simulated proportion overcoming vulnerabilities"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Simulation density"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.6</span><span class="op">)</span>

<span class="va">plot_option5</span></code></pre></div>
<p><img src="Nigeria_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model5</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="op">(</span><span class="va">DS_perc</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span> <span class="op">~</span> <span class="va">I1</span><span class="op">+</span><span class="va">I4</span><span class="op">+</span><span class="va">I5</span><span class="op">+</span><span class="va">I6</span><span class="op">+</span><span class="va">I8</span><span class="op">+</span><span class="va">I9</span>, data<span class="op">=</span> <span class="va">DS_Option5</span><span class="op">)</span><span class="op">)</span>
<span class="va">model5</span> <span class="op">&lt;-</span> <span class="va">model5</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">estimate</span> <span class="op">-</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">std.error</span><span class="op">)</span>,
         ymax <span class="op">=</span> <span class="va">estimate</span> <span class="op">+</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">std.error</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">term</span> <span class="op">!=</span> <span class="st">"(Intercept)"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>category <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"([0-9]+).*$"</span>, <span class="st">"\\1"</span>, <span class="va">term</span><span class="op">)</span>,
         term <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">".*?_"</span>,<span class="st">""</span>,<span class="va">term</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>term <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">term</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span>, ordered<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="visualization" class="section level1">
<h1 class="hasAnchor">
<a href="#visualization" class="anchor"></a>VISUALIZATION</h1>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># VISUALIZATION ########################################</span>

<span class="op">(</span><span class="va">plot_original</span> <span class="op">+</span> <span class="va">plot_option1</span><span class="op">)</span> <span class="op">/</span> 
  <span class="op">(</span><span class="va">plot_option2</span> <span class="op">+</span> <span class="va">plot_option3</span><span class="op">)</span><span class="op">/</span> 
  <span class="op">(</span><span class="va">plot_option4</span> <span class="op">+</span> <span class="va">plot_option5</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_density).</code></pre>
<p><img src="Nigeria_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#ggsave("inst/Nigeria_option.png",   width = 11, height = 8)</span>

<span class="va">indicator_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  term <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">term</span>,
  estimate <span class="op">=</span>
    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">24</span>,  
           <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
             <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,<span class="va">model1</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,<span class="va">model2</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,
                  <span class="va">model4</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,<span class="va">model5</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="va">x</span><span class="op">]</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>,
  ymin <span class="op">=</span>
    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">24</span>,  
           <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
             <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">ymin</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,<span class="va">model1</span><span class="op">$</span><span class="va">ymin</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,<span class="va">model2</span><span class="op">$</span><span class="va">ymin</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,
                  <span class="va">model4</span><span class="op">$</span><span class="va">ymin</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,<span class="va">model5</span><span class="op">$</span><span class="va">ymin</span><span class="op">[</span><span class="va">x</span><span class="op">]</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>,
  ymax <span class="op">=</span>
    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">24</span>,  
           <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
             <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">ymax</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,<span class="va">model1</span><span class="op">$</span><span class="va">ymax</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,<span class="va">model2</span><span class="op">$</span><span class="va">ymax</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,
                  <span class="va">model4</span><span class="op">$</span><span class="va">ymax</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,<span class="va">model5</span><span class="op">$</span><span class="va">ymax</span><span class="op">[</span><span class="va">x</span><span class="op">]</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>
  
<span class="op">)</span><span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>term <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">term</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span>, ordered<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>term1 <span class="op">=</span> 
           <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1.1: Access to dispute resolution"</span>,<span class="st">"1.1: Effective dispute resolution"</span>,<span class="st">"1.1: Formal dispute resolution"</span>,<span class="st">"1.1: Experience security incident"</span>, <span class="st">"1.1: Feeling safe at night"</span>,<span class="st">"1.1: Report security incident"</span>,<span class="st">"1.1: Feeling safe"</span>,
             <span class="st">"2.2: No overcrowded housing"</span>,<span class="st">"2.2: Owning/renting house"</span>,<span class="st">"2.2: No squatting"</span>,<span class="st">"2.2: Temporary accommendation"</span>,<span class="st">"2.2: Toilet facilities"</span>,<span class="st">"2.2: No obstacles to water"</span>, <span class="st">"2.2: Water access"</span>,<span class="st">"2.2. Legally own tenure"</span>,
              <span class="st">"2.3: Distance to health facility"</span>, 
             <span class="st">"2.4: Satisfied with school"</span>,    
             <span class="st">"3.2: Consume above average"</span>, <span class="st">"3.2: Low food to total ratio"</span>,<span class="st">"3.2: Distance to market"</span>,<span class="st">"3.2: Below 1.9 USD Poverty Line"</span>,<span class="st">"3.2: Below 1.25 USD Poverty Line"</span>,<span class="st">"3.2: Below 3.1 USD Poverty Line"</span>,
             <span class="st">"4.1: Legally own dwelling"</span>
           <span class="op">)</span><span class="op">)</span><span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>term1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">term1</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">term1</span><span class="op">)</span>, ordered<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>


<span class="fu">ggplot</span><span class="op">(</span><span class="va">indicator_data</span>, 
       <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">term1</span>, y<span class="op">=</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0</span>, colour<span class="op">=</span><span class="st">"#8C2318"</span>, size<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Line at 0</span>
  <span class="fu">geom_pointrange</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin<span class="op">=</span><span class="va">ymin</span>, ymax<span class="op">=</span><span class="va">ymax</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Indicator"</span>, y<span class="op">=</span><span class="st">"Average effect estimate across metrices (in percentages of IDP stock)"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Labels</span>
  <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/viridis/man/scale_viridis.html">scale_color_viridis</a></span><span class="op">(</span>discrete <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_rect</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin<span class="op">=</span><span class="fl">0.4</span>, ymax<span class="op">=</span> <span class="fl">0.82</span>, xmin<span class="op">=</span><span class="fl">0</span>, xmax<span class="op">=</span><span class="cn">Inf</span><span class="op">)</span>,
            fill<span class="op">=</span> <span class="st">"lightskyblue3"</span>,
            alpha <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_rect</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin<span class="op">=</span><span class="op">-</span><span class="fl">0.21</span>, ymax<span class="op">=</span> <span class="fl">0.23</span>, xmin<span class="op">=</span><span class="fl">0</span>, xmax<span class="op">=</span><span class="cn">Inf</span><span class="op">)</span>,
            fill<span class="op">=</span> <span class="st">"lightskyblue4"</span>,
            alpha <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_rect</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin<span class="op">=</span><span class="fl">1.1</span>, ymax<span class="op">=</span> <span class="fl">1.43</span>, xmin<span class="op">=</span><span class="fl">0</span>, xmax<span class="op">=</span><span class="cn">Inf</span><span class="op">)</span>,
            fill<span class="op">=</span> <span class="st">"lightskyblue"</span>,
            alpha <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Rotate the plot</span>
  <span class="fu"><a href="https://rdrr.io/pkg/hrbrthemes/man/theme_ipsum.html">theme_ipsum</a></span><span class="op">(</span>plot_title_size <span class="op">=</span> <span class="fl">13</span>, base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></code></pre></div>
<p><img src="Nigeria_files/figure-html/unnamed-chunk-20-2.png" width="700"></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#ggsave("inst/Nigeria_indicators.png",width = 8, height = 5)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Sigrid Weber.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
